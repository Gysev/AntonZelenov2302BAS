Задание 1. Создание базового REST API

В рамках первого задания был разработан базовый REST API с использованием Spring Boot. Проект был инициализирован с подключением основных зависимостей, необходимых для создания веб-приложения, включая Spring Web и Spring Data JPA. Была сформирована базовая архитектура приложения с разделением на слои контроллеров, сервисов и репозиториев. Реализованы основные REST-эндпоинты для работы с сущностями предметной области, поддерживающие операции создания, чтения, обновления и удаления данных (CRUD). Обмен данными между клиентом и сервером осуществляется в формате JSON.

Для хранения данных использовалась встроенная база данных H2 в режиме in-memory, что позволило упростить процесс разработки и тестирования. Работа с базой данных была реализована через Spring Data JPA, что обеспечило удобный доступ к данным без необходимости писать SQL-запросы вручную. В результате было получено работоспособное REST API, корректно обрабатывающее HTTP-запросы и готовое к дальнейшему расширению функциональности.

Задание 2. Валидация входных данных и обработка ошибок

Во втором задании была реализована валидация входных данных для REST-эндпоинтов. Для этого использовались аннотации Spring Validation, которые позволили задать ограничения на поля входных DTO-объектов (обязательные поля, формат данных, длина строк и другие правила). Это обеспечило защиту приложения от некорректных или неполных данных, поступающих от клиента, и повысило надёжность работы API.

Дополнительно была настроена централизованная обработка ошибок с использованием механизма глобальных обработчиков исключений. Это позволило возвращать клиенту понятные и структурированные сообщения об ошибках с корректными HTTP-статусами. В результате API стало устойчивым к ошибочным запросам, а клиентская сторона получила предсказуемое и удобное поведение при возникновении ошибок.

Задание 3. Работа с базой данных и бизнес-логикой

**Тема проекта:** Система управления доставками

**Основные сущности:**
- **Sender** (Отправитель) - информация об отправителе посылки
- **Recipient** (Получатель) - информация о получателе посылки
- **Courier** (Курьер) - информация о курьере, его доступности и нагрузке
- **Parcel** (Посылка) - информация о посылке (отслеживание, описание, вес)
- **Delivery** (Доставка) - информация о доставке, её статусе, SLA и расписании

**Бизнес-операции (5 основных операций + создание заказа):**

1. **Создание заказа**
   - Эндпоинт: `POST /api/business/orders`
   - Создает новый заказ с посылкой и назначением курьера
   - Автоматически устанавливает SLA deadline

2. **Автоматическое перераспределение доставок при недоступности курьера**
   - Эндпоинт: `POST /api/business/couriers/unavailable/redistribute`
   - При недоступности курьера все его активные доставки автоматически перераспределяются другим доступным курьерам с учётом их нагрузки
   - Каскадная логика: освобождение недоступного курьера, обновление нагрузки всех задействованных курьеров

3. **Умное назначение курьера с учётом нагрузки**
   - Эндпоинт: `POST /api/business/deliveries/smart-assign`
   - Автоматически выбирает курьера с наименьшей нагрузкой для доставки
   - Учитывает максимальную нагрузку курьера
   - Обновляет нагрузку курьера при назначении

4. **Отложенная доставка с автоматической активацией**
   - Эндпоинт: `POST /api/business/deliveries/schedule`
   - Позволяет создать доставку, которая будет автоматически активирована в указанное время
   - Доставка переводится в статус SCHEDULED и активируется по расписанию

5. **Частичная отмена заказа с компенсацией**
   - Эндпоинт: `POST /api/business/orders/partial-cancel`
   - Отменяет заказ с начислением компенсации клиенту
   - Освобождает курьера и уменьшает его нагрузку
   - Сохраняет информацию о причине отмены и сумме компенсации

6. **Контроль SLA и автоматическое помечание просрочек**
   - Эндпоинт: `POST /api/business/deliveries/check-sla`
   - Проверяет все активные доставки на просрочку SLA
   - Автоматически помечает просроченные доставки статусом OVERDUE
   - Возвращает статистику по проверенным и просроченным доставкам

Все операции реализованы с использованием транзакций для обеспечения целостности данных.

Задание 4. Базовая безопасность API

В четвёртом задании в проект была интегрирована Spring Security для обеспечения базовой безопасности REST API. Было настроено использование HTTP Basic Authentication, а также реализована работа с CSRF-токенами. Для этого был добавлен отдельный эндпоинт для получения CSRF-токена, который используется при выполнении защищённых операций изменения данных (POST, PUT, DELETE).

Также была реализована система пользователей и ролей, при которой пользователи хранятся в базе данных, а пароли сохраняются исключительно в зашифрованном виде. Для различных эндпоинтов были настроены правила доступа на основе ролей, что позволило ограничить выполнение отдельных операций только авторизованным пользователям с соответствующими правами.

**Важные особенности безопасности:**
- Регистрация пользователя с именем "admin" (в любом регистре) запрещена через API
- Пользователи могут быть созданы только с ролью USER через регистрацию
- Роль ADMIN может быть назначена только вручную через базу данных (см. `SQL_INSTRUCTIONS.md`)
- Все запросы к API требуют аутентификации (кроме публичных эндпоинтов)
- Используется stateless-сессия для REST API (каждый запрос требует аутентификацию)

В результате API стало защищённым, а доступ к функциональности приложения — контролируемым и соответствующим требованиям базовой безопасности.